!function(e){var t={};function o(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,o),s.l=!0,s.exports}o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)o.d(n,s,function(t){return e[t]}.bind(null,s));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=0)}([function(e,t,o){"use strict";function n(e){const t=function(e){let t=null;if(document.cookie&&""!==document.cookie){const o=document.cookie.split(";");for(let n=0;n<o.length;n++){const s=o[n].trim();if(s.substring(0,e.length+1)===e+"="){t=decodeURIComponent(s.substring(e.length+1));break}}}return t}("csrftoken");e.setRequestHeader("X-CSRFToken",t)}function s(e){e.stopPropagation();const t=e.currentTarget;let o=t.dataset.action;const s=t.dataset.entryid;-1!==t.querySelector(".arrow").querySelector(".arrow-body").className.indexOf("voted")&&(o=o[0].toUpperCase()+o.slice(1),o=`cancel${o}`),function(e,t){let o=new XMLHttpRequest;o.open("POST","/api/vote",!0),n(o),o.setRequestHeader("Content-Type","application/json"),o.send(JSON.stringify({entry:e,action:t,type:"post"}));const s=document.getElementById(`post-${e}`),r=s.querySelector(".upvote").querySelector(".arrow-body"),a=s.querySelector(".downvote").querySelector(".arrow-body"),c=s.querySelector(".post__karma");o.onload=function(){switch(o.status){case 200:const e=JSON.parse(o.response);console.log(e),c.innerHTML=String(e.total),"UPVOTE"===e.action?(r.classList.add("upvoted"),c.classList.add("upvoted"),c.classList.remove("downvoted"),a.classList.remove("downvoted")):"DOWNVOTE"===e.action?(a.classList.add("downvoted"),r.classList.remove("upvoted"),c.classList.add("downvoted"),c.classList.remove("upvoted")):"UNVOTE"===e.action&&(r.classList.remove("upvoted"),a.classList.remove("downvoted"),c.classList.remove("downvoted"),c.classList.remove("upvoted"));break;case 500:case 400:case 403:switch(c.innerHTML=s.dataset.karma,t){case"upvote":r.classList.remove("upvoted"),c.classList.remove("upvoted");break;case"downvote":a.classList.remove("downvoted"),c.classList.remove("downvoted");break;default:console.log("action")}break;default:console.log(o.status)}o.status}}(s,o)}o.r(t);const r=document.getElementsByClassName("upvote-action");for(let e=0;e<r.length;e++)r.hasOwnProperty(e)&&(r[e].onclick=s);const a=document.getElementsByClassName("downvote-action");for(let e=0;e<a.length;e++)a.hasOwnProperty(e)&&(a[e].onclick=s);const c=document.getElementsByClassName("post");for(let e=0;e<c.length;e++)if(c.hasOwnProperty(e)){const t=c[e],o=t.dataset.status,n=t.querySelector(".upvote .arrow-body"),s=t.querySelector(".downvote .arrow-body"),r=t.querySelector(".post__karma");o&&("upvote"===o?(n.classList.add("upvoted"),r.classList.add("upvoted")):"downvote"===o&&(s.classList.add("downvoted"),r.classList.add("downvoted")))}}]);